<!DOCTYPE html>












  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.4.1" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.4.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.4.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.4.1">


  <link rel="mask-icon" href="/images/logo.svg?v=6.4.1" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '6.4.1',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="LYJ-NEO">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="LYJ-NEO">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="LYJ-NEO">






  <link rel="canonical" href="http://yoursite.com/page/2/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>LYJ-NEO</title>
  






  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?0a1c584f1b6f1f91344a2a4d65406eff";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">LYJ-NEO</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">Gone With The Wind</p>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br />关于</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />标签</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br />分类</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/11/PySpark-ml-随机森林/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/fly.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LYJ-NEO">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/11/PySpark-ml-随机森林/" itemprop="url">
                  PySpark-ml-随机森林
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-01-11 14:55:01" itemprop="dateCreated datePublished" datetime="2020-01-11T14:55:01+08:00">2020-01-11</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-02-04 14:48:27" itemprop="dateModified" datetime="2020-02-04T14:48:27+08:00">2020-02-04</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tec/" itemprop="url" rel="index"><span itemprop="name">Tec</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>书籍&lt;&lt;Python在大数据平台的应用&gt;&gt;<br>更多信息请关注本书附书代码:<a href="https://github.com/Shadow-Hunter-X/python_practice_stepbystep" target="_blank" rel="noopener">附书代码Github工程:https://github.com/Shadow-Hunter-X</a></p>
<h2 id="信息熵-熵的计算"><a href="#信息熵-熵的计算" class="headerlink" title="信息熵-熵的计算"></a>信息熵-熵的计算</h2><ul>
<li>信息熵：常被用来作为一个系统的信息含量的量化指标，从而可以进一步用来作为系统方程优化的目标或者参数选择的判据,<pre><code>可以作为一个系统复杂程度的度量，如果系统越复杂，出现不同情况的种类越多，那么他的信息熵是比较大的。
</code></pre></li>
</ul>
<p><img src="/2020/01/11/PySpark-ml-随机森林/entropy.png" alt="entropy.png"></p>
<ul>
<li>信息熵的三个性质<ul>
<li>单调性，即发生概率越高的事件，其所携带的信息熵越低</li>
<li>非负性，即信息熵不能为负</li>
<li>累加性，即多随机事件同时发生存在的总不确定性的量度是可以表示为各事件不确定性的量度的和</li>
</ul>
</li>
</ul>
<p>可以发现,上述的公式中计算是相当与 将所有的期望值相加了。</p>
<p>设想：在一个封闭系统的盒子中，其中有各种的信息源，这些信息源间，可能相互关联，或彼此独立。现在从这个盒子外部看接受信息。</p>
<pre><code>对于单调性 ： 如果 盒子中只有一个数据源，每次都可以确定信息，这样对应的必然事件，对应的概率是1，对于熵值为0 。

累加性：如果盒子中有很多数据源，两个独立数据源发生时的概率：P(A)*P(B) ；两个关联事件发生的条件概率为 P(A|B) = P(A∩B)/P(B)
       可以发现需要间概率计算中的乘除转为为可以进行累加，所以使用对数进行处理，这样可以将概率计算中的乘除化解为加减。
</code></pre><p>结合概率统计中概率计算<br><a href="https://blue-shadow.top/2019/02/06/4%E6%A6%82%E7%8E%87%E8%AE%A1%E7%AE%97/" target="_blank" rel="noopener">概率计算及相关</a></p>
<h2 id="决策树-Decision-Tree"><a href="#决策树-Decision-Tree" class="headerlink" title="决策树-Decision Tree"></a>决策树-Decision Tree</h2><p><strong>由于随机森林是由很多的决策树构成的，所以在使用随机森林模型前，先了解决策树中的构建过程，有助于对随机森林的学习</strong></p>
<ul>
<li>使用如下测试表中的数据来说明：</li>
</ul>
<table>
<thead>
<tr>
<th>年龄段</th>
<th>是否购车</th>
<th>是否购房</th>
<th>薪资水平</th>
<th>贷款额度</th>
</tr>
</thead>
<tbody>
<tr>
<td>中年</td>
<td>是</td>
<td>是</td>
<td>高</td>
<td>高</td>
</tr>
<tr>
<td>少年</td>
<td>是</td>
<td>是</td>
<td>中等</td>
<td>高</td>
</tr>
<tr>
<td>青年</td>
<td>是</td>
<td>是</td>
<td>中等</td>
<td>低</td>
</tr>
<tr>
<td>中年</td>
<td>否</td>
<td>是</td>
<td>高</td>
<td>高</td>
</tr>
<tr>
<td>青年</td>
<td>是</td>
<td>是</td>
<td>高</td>
<td>低</td>
</tr>
<tr>
<td>少年</td>
<td>否</td>
<td>是</td>
<td>低</td>
<td>高</td>
</tr>
<tr>
<td>少年</td>
<td>否</td>
<td>否</td>
<td>低</td>
<td>低</td>
</tr>
<tr>
<td>中年</td>
<td>否</td>
<td>否</td>
<td>低</td>
<td>高</td>
</tr>
<tr>
<td>少年</td>
<td>否</td>
<td>是</td>
<td>中等</td>
<td>高</td>
</tr>
<tr>
<td>青年</td>
<td>否</td>
<td>是</td>
<td>低</td>
<td>高</td>
</tr>
<tr>
<td>青年</td>
<td>是</td>
<td>否</td>
<td>高</td>
<td>低</td>
</tr>
<tr>
<td>少年</td>
<td>是</td>
<td>否</td>
<td>中等</td>
<td>低</td>
</tr>
<tr>
<td>青年</td>
<td>否</td>
<td>否</td>
<td>中等</td>
<td>高</td>
</tr>
<tr>
<td>中年</td>
<td>是</td>
<td>否</td>
<td>中等</td>
<td>高</td>
</tr>
</tbody>
</table>
<ul>
<li>对于决策树的计算中，需要使用到熵</li>
</ul>
<p>为了能够计算目标变量-贷款额度，需要计算每类的概率，然后使用熵公式进行计算。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">高贷款额度概率 : 9/14 = 0.64</span><br><span class="line">低贷款额度概率 ：5/14 = 0.36</span><br><span class="line"></span><br><span class="line">所以 熵值为 ： E(贷款额度) = - P(高贷款额度) * log(2)(P(高贷款额度))  - P(低贷款额度) * log(2)(P(低贷款额度))  </span><br><span class="line">                = -( 0.64 * log(2)(0.64)) - (0.36 * log(2)(0.36))</span><br><span class="line">                = -( 0.64 * -0.643856 ) - (0.36 * -1.473931)</span><br><span class="line">                = 0.41206784 + 0.53061516</span><br><span class="line">                = 0.94</span><br></pre></td></tr></table></figure>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2020/01/11/PySpark-ml-随机森林/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/03/PySpark-推荐系统-RecommenderSystem/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/fly.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LYJ-NEO">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/03/PySpark-推荐系统-RecommenderSystem/" itemprop="url">
                  PySpark-推荐系统-RecommenderSystem
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-01-03 14:59:37" itemprop="dateCreated datePublished" datetime="2020-01-03T14:59:37+08:00">2020-01-03</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-02-04 14:49:00" itemprop="dateModified" datetime="2020-02-04T14:49:00+08:00">2020-02-04</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tec/" itemprop="url" rel="index"><span itemprop="name">Tec</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>书籍&lt;&lt;Python在大数据平台的应用&gt;&gt;<br>更多信息请关注本书附书代码:<a href="https://github.com/Shadow-Hunter-X/python_practice_stepbystep" target="_blank" rel="noopener">附书代码Github工程:https://github.com/Shadow-Hunter-X</a></p>
<h2 id="推荐系统"><a href="#推荐系统" class="headerlink" title="推荐系统"></a>推荐系统</h2><p>自动推荐内容或产品以个性化的方式向适当的用户提供,以增强整体体验。推荐系统在术语上非常强大使用海量的数据,学会理解偏好。</p>
<p>对于PySpark中的“推荐系统”模块 <strong>pyspark.ml.recommendation module</strong><br><a href="http://spark.apache.org/docs/latest/api/python/pyspark.ml.html#module-pyspark.ml.recommendation" target="_blank" rel="noopener">官方文档链接：api/python/pyspark.ml.html#module-pyspark.ml.recommendation</a></p>
<h2 id="spark-推荐系统的ALS-算法"><a href="#spark-推荐系统的ALS-算法" class="headerlink" title="spark 推荐系统的ALS 算法"></a>spark 推荐系统的ALS 算法</h2><ul>
<li>交替最小平方 (ALS) 矩阵分解:<br>ALS 尝试将评级矩阵 R 估计为两个较低级别矩阵(X 和 Y,即 X = Yt = R)的乘积。一般方法是迭代。在每次迭代期间,一个因子矩阵保持不变,而另一个因子矩阵使用最小二乘求解。然后,在求解另一个因子矩阵时,新求解的因子矩阵保持不变。</li>
</ul>
<ul>
<li><p>现实场景到推荐系统模型的转换 ; 构建模型 中的转换关系</p>
<ul>
<li>划分出推荐系统中参与的对象,如在线购物网站中，参与的主要对象是购物者和相关的商品。</li>
<li>将这些对象的按维度属性进行划分，通过这些维度属性可以有效的表示这个对象。如购物者可以通过 年龄，性别，所住城市等这些属性进行表示。</li>
<li>将对象通过对应的属性维度构建好后。假设每个对象可以通过一个函数表示,如: ax1 + bx2 + cx3 + dx4 = y 。为每个对象，依据分配的属性维度个数，构建有相同元的函数。</li>
<li>通过不同对象个体的属性维度值构建矩阵,构建好不同对象的矩阵后，进行矩阵相乘。得到的新矩阵可以认为是每个购物者对相关物品的关联程度。</li>
<li>由于对象的函数表示，是通过假设的，所以需要获取最优函数的办法，即通过使用最小二乘法来获取最佳函数。</li>
</ul>
</li>
<li><p>关于最小二乘法：<br>  它通过最小化误差的平方和寻找数据的最佳函数匹配。利用最小二乘法可以简便地求得未知的数据，并使得这些求得的数据与实际数据之间误差的平方和为最小。<br>最小二乘法还可用于曲线拟合。其他一些优化问题也可通过最小化能量或最大化熵用最小二乘法来表达。</p>
<p>  通俗的说：在平面(也可再高维度空间种)上有若干点，需要使用一个函数来表示这些点；如何确定这个函数是最优的；通过在坐标系上，每个点到这个函数对应的图形的距离的和最小，<br>由于拟合函数可以有很多种，但是求两点的具体方法：坐标值差的平方的和，后再开方。 把这些值都加起来后求最小情况，就是最小二乘法。</p>
</li>
</ul>
<p>使用最小二乘法的，不同拟合曲线：</p>
<p><img src="/2020/01/03/PySpark-推荐系统-RecommenderSystem/fitted.png" alt="不同函数的拟合曲线"></p>
<h2 id="推荐系统的分类"><a href="#推荐系统的分类" class="headerlink" title="推荐系统的分类"></a>推荐系统的分类</h2><p><strong>基于内容推荐</strong><br>    基于内容的推荐（Content-based Recommendation）是信息过滤技术的延续与发展，它是建立在项目的内容信息上作出推荐的，而不需要依据用户对项目的评价意见，更多地需要用机 器学习的方法从关于内容的特征描述的事例中得到用户的兴趣资料</p>
<p><strong>协同过滤推荐</strong><br>    协同过滤推荐（Collaborative Filtering Recommendation）技术是推荐系统中应用最早和最为成功的技术之一。它一般采用最近邻技术，利用用户的历史喜好信息计算用户之间的距离，然后 利用目标用户的最近邻居用户对商品评价的加权评价值来预测目标用户对特定商品的喜好程度，系统从而根据这一喜好程度来对目标用户进行推荐</p>
<p><strong>基于关联规则推荐</strong><br>    基于关联规则的推荐（Association Rule-based Recommendation）是以关联规则为基础，把已购商品作为规则头，规则体为推荐对象。关联规则挖掘可以发现不同商品在销售过程中的相关性，在零 售业中已经得到了成功的应用</p>
<p><strong>基于知识推荐</strong><br>    基于知识的推荐（Knowledge-based Recommendation）在某种程度是可以看成是一种推理（Inference）技术，它不是建立在用户需要和偏好基础上推荐的。基于知识的方法因 它们所用的功能知识不同而有明显区别</p>
<p><strong>组合推荐</strong><br>    由于各种推荐方法都有优缺点，所以在实际中，组合推荐（Hybrid Recommendation）经常被采用。研究和应用最多的是内容推荐和协同过滤推荐的组合。最简单的做法就是分别用基于内容的方法和协同过滤推荐方法 去产生一个推荐预测结果，然后用某方法组合其结果</p>
<p><strong>基于效用推荐</strong><br>    基于效用的推荐（Utility-based Recommendation）是建立在对用户使用项目的效用情况上计算的，其核心问题是怎么样为每一个用户去创建一个效用函数，因此，用户资料模型很大 程度上是由系统所采用的效用函数决定的。基于效用推荐的好处是它能把非产品的属性，如提供商的可靠性（Vendor Reliability）和产品的可得性（Product Availability）等考虑到效用计算中</p>
<p><img src="/2020/01/03/PySpark-推荐系统-RecommenderSystem/Collaborative_filtering.gif" alt="wiki上关于推荐系统"><br></p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2020/01/03/PySpark-推荐系统-RecommenderSystem/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/01/PySpark-ml-逻辑回归/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/fly.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LYJ-NEO">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/01/PySpark-ml-逻辑回归/" itemprop="url">
                  PySpark-ml-逻辑回归
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2020-01-01 14:52:44" itemprop="dateCreated datePublished" datetime="2020-01-01T14:52:44+08:00">2020-01-01</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-02-04 14:49:07" itemprop="dateModified" datetime="2020-02-04T14:49:07+08:00">2020-02-04</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tec/" itemprop="url" rel="index"><span itemprop="name">Tec</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>书籍&lt;&lt;Python在大数据平台的应用&gt;&gt;<br>更多信息请关注本书附书代码:<a href="https://github.com/Shadow-Hunter-X/python_practice_stepbystep" target="_blank" rel="noopener">附书代码Github工程:https://github.com/Shadow-Hunter-X</a></p>
<h2 id="Logit模型"><a href="#Logit模型" class="headerlink" title="Logit模型"></a>Logit模型</h2><p>Logit模型（Logit model，也译作“评定模型”，“分类评定模型”，又作Logistic regression，“逻辑回归”）是离散选择法模型之一，Logit模型是最早的离散选择模型，也是目前应用最广的模型</p>
<p>逻辑回归属于分类算法。逻辑回归可以进行多分类操作，但由逻辑回归算法本身性质决定其更常用于二分类,即: 对-错,好-坏等</p>
<h3 id="逻辑回归的公式："><a href="#逻辑回归的公式：" class="headerlink" title="逻辑回归的公式："></a>逻辑回归的公式：</h3><p><img src="/2020/01/01/PySpark-ml-逻辑回归/fromula.jpg" alt="fromula.jpg"></p>
<p>其中，Y为决策值，x为特征值，e为自然对数。</p>
<p><img src="/2020/01/01/PySpark-ml-逻辑回归/pic.jpg" alt="pic.jpg"></p>
<p>该函数是一条S形的曲线，并且曲线在中心点附近的增长速度较快，在两段的增长速度较慢。w值越大，曲线中心的增长速度越快。从图上可知，Y的值域为(0,1)，<br>那么就可以将决策函数值大于等于0.5的具有对应x属性的对象归为正样本，决策函数值小于0.5的具有对应x属性的对象归为负样本。这样就可以对样本 数据进行二分类。</p>
<p>使用的测试数据为-不同国家的人通过不同的搜索引擎查找访问网站的数据,数据的表头如下:</p>
<p><img src="/2020/01/01/PySpark-ml-逻辑回归/data_demo.png" alt="data_demo.png"></p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2020/01/01/PySpark-ml-逻辑回归/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/23/Data-Vault-数据仓库模型构建-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/fly.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LYJ-NEO">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/23/Data-Vault-数据仓库模型构建-3/" itemprop="url">
                  Data Vault 数据仓库模型构建-3
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-02-23 14:39:31" itemprop="dateCreated datePublished" datetime="2019-02-23T14:39:31+08:00">2019-02-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-02-03 14:39:11" itemprop="dateModified" datetime="2020-02-03T14:39:11+08:00">2020-02-03</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tec/" itemprop="url" rel="index"><span itemprop="name">Tec</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="在Data-Vault模型基础上构建数据集市"><a href="#在Data-Vault模型基础上构建数据集市" class="headerlink" title="在Data Vault模型基础上构建数据集市"></a>在Data Vault模型基础上构建数据集市</h2><p>数据仓库抽取数据的过程中，特别是第一次导入之后的每一次增量抽取往往会遇到这样的问题：业务数据库中的一些数据发生了更改，到底要不要将这些变化也反映到数据仓库中？<br>在数据仓库中，哪些数据应该随之变化，哪些可以不用变化？考虑到这些变化，在数据仓库中的维度表又应该如何设计以满足这些需要</p>
<p>但是在数据仓库中，其数据主要的特征一是静态历史数据，二是少改变不删除，三是定期增长，其作用主要用来数据分析。因此分析的过程中对历史数据就提出了要求，<br>有一些数据是需要能够反映出在周期内的变化历史，有一些数据缺不需要，那么这些数据应该如何来控制。</p>
<h4 id="渐变维度1类-Type-1-SCD"><a href="#渐变维度1类-Type-1-SCD" class="headerlink" title="渐变维度1类 - Type 1 SCD"></a>渐变维度1类 - Type 1 SCD</h4><ul>
<li>保持业务数据和数据仓库中的数据始终处于一致。</li>
<li>不记录历史数据。一切不需要维护的历史数据都可以选择这种类型。</li>
</ul>
<h4 id="渐变维度2类-Type-2-SCD"><a href="#渐变维度2类-Type-2-SCD" class="headerlink" title="渐变维度2类 - Type 2 SCD"></a>渐变维度2类 - Type 2 SCD</h4><ul>
<li>尽可能的维护来自业务系统中的历史数据，能够真正捕获到这种历史数据的变化</li>
<li>添加新的数据。使用的比较常见，基本上除了Type 1之外的情形都会优先考虑这种类型。</li>
</ul>
<h4 id="渐变维度3类-Type-3-SCD"><a href="#渐变维度3类-Type-3-SCD" class="headerlink" title="渐变维度3类 - Type 3 SCD"></a>渐变维度3类 - Type 3 SCD</h4><ul>
<li>添加历史列。不会追踪所有的历史记录，只会追踪上一次的历史信息。需要记录历史数据，但是又不需要记录那么多。</li>
</ul>
<p>在不同的工具中对 SCD 的实现是不一样的,要关注的重点应该是具体的实现方式和解决思路的原型。</p>
<h2 id="构建过程"><a href="#构建过程" class="headerlink" title="构建过程"></a>构建过程</h2><p>最好先构建需要的PIT表和Bridge表，这样呢能够方便进行处理.</p>
<h4 id="构建渐变维度1类的数据集市"><a href="#构建渐变维度1类的数据集市" class="headerlink" title="构建渐变维度1类的数据集市"></a>构建渐变维度1类的数据集市</h4><p>它显示所有属性的最新值, 我们可以使用hub表(中心表)的键作为维度的代理主键 (PK)。建议使用现有的hub表中的代理键(MD5哈希列), 因为它已经是唯一的,<br>并将节省为维度生成典型整数代理项的过程。这将节省处理时间, 并允许在维度之前或与维度并行加载事实数据表。维度中的所有其他列都将来自贡献hub和Satellite表。</p>
<p>以已经构建好的 NorthWind DV模型为基础，构建 渐变1类维度表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1</span><br></pre></td></tr></table></figure>
<h4 id="构建渐变维度2类的数据集市"><a href="#构建渐变维度2类的数据集市" class="headerlink" title="构建渐变维度2类的数据集市"></a>构建渐变维度2类的数据集市</h4><p>渐变维度2类只是稍微困难一些。由于类型2跟踪值随时间变化, 这意味着每个业务主键的维度中可能有多行。因此,不能将hub表的业务主键用作维度表上的主键。<br>如果使用的是DV2.0, 那么建议使用与原始DV模型中相同的MD5哈希方法来创建代理主键。因此, 要在这种情况下获得唯一键,需要创建一个基于业务主键加上SAT_LOAD_DTS的哈希键。</p>
<p>以已经构建好的 NorthWind DV模型为基础，构建 渐变2类维度表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1</span><br></pre></td></tr></table></figure>
<h4 id="构建事实表"><a href="#构建事实表" class="headerlink" title="构建事实表"></a>构建事实表</h4>
          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/23/Data-Vault-数据仓库模型构建-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/fly.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LYJ-NEO">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/23/Data-Vault-数据仓库模型构建-2/" itemprop="url">
                  Data Vault 数据仓库模型构建-2
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-02-23 14:39:23" itemprop="dateCreated datePublished" datetime="2019-02-23T14:39:23+08:00">2019-02-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-02-03 14:49:16" itemprop="dateModified" datetime="2020-02-03T14:49:16+08:00">2020-02-03</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tec/" itemprop="url" rel="index"><span itemprop="name">Tec</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h3 id="相关概念"><a href="#相关概念" class="headerlink" title="相关概念"></a>相关概念</h3><ul>
<li><p>Data Vault 原始数据模型：<br>  当大多数人说 “数据库” 时, 他们指的是我们现在可能称之为原始保管库的东西。在添加业务保管库之前,<br>原始保险库被普遍称为 “数据库”, 添加了 “原始” 一词, 以便我们可以清楚地知道我们正在讨论的架构的哪一部分。</p>
</li>
<li><p>Raw Vault 原始数据：<br>  它是来自源的未经过滤的原始数据, 即加载到基于业务密钥的集线器、链接和卫星中的数据格式。</p>
</li>
<li><p>Business Vault 业务数据模型<br>  它是原始保管库的扩展, 它应用选定的业务规则、非规范化、计算和其他查询帮助功能, 以方便用户访问和报告。<br>一旦刷新了业务保管库表的依赖项, 就应该刷新它们。</p>
</li>
</ul>
<p>对于 Business Vault模型 ： </p>
<pre><code>它首先在 dv 样式表 (即集线器、链接表和 sats) 中进行建模, 但它不是原始保管库中所有对象的完整副本。
</code></pre><p>它是有选择性的, 因为我们只创建具有一些重要商业价值的结构。在这种情况下, 我们将以某种方式转换数据, 以应用大多数业务用户会</p>
<p>发现有用的规则或函数 (而不是反复将这些操作转换为多个集市)。这包括数据清理、数据质量、会计规则或定义良好的可重复计算等内容。</p>
<p>使用或访问 bv 的主要组是您的高级用户。这些人很好地理解 sql 和关系模型, 并且不怕有许多表联接 。</p>
<ul>
<li>PIT表<br>  PIT表是一种经过修改的卫星, 当我们需要从具有多个卫星查询数据时, 它将有所帮助。具体的操作是将一个卫星表，进行拆分层若干表，拆分的依据是一下几点<br>  <strong>将一张卫星表拆解成若干表，对于拆解后的若干表的主键不变，还是原来的卫星表的主键，只是根据不同的属性特点，进行不同的分解</strong><ul>
<li>有多个源系统具有来自每个源的不同属性</li>
<li>要拆分特定的数据分类</li>
<li>某些属性的变化率 (如果比其他属性慢)<br>拆分的各表，统一在一张表中进行记录，如下图。</li>
</ul>
</li>
</ul>
<p><img src="/2019/02/23/Data-Vault-数据仓库模型构建-2/pit_added.png" alt="pit-added.png"><br></p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2019/02/23/Data-Vault-数据仓库模型构建-2/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/23/Data-Vault-数据仓库模型构建-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/fly.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LYJ-NEO">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/02/23/Data-Vault-数据仓库模型构建-1/" itemprop="url">
                  Data Vault 数据仓库模型构建-1
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-02-23 14:39:15" itemprop="dateCreated datePublished" datetime="2019-02-23T14:39:15+08:00">2019-02-23</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-02-03 14:39:19" itemprop="dateModified" datetime="2020-02-03T14:39:19+08:00">2020-02-03</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tec/" itemprop="url" rel="index"><span itemprop="name">Tec</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="关于Data-Vault数据模型"><a href="#关于Data-Vault数据模型" class="headerlink" title="关于Data Vault数据模型"></a>关于Data Vault数据模型</h3><ul>
<li><p>Data Vault是一种数据仓库建模方法，用来存储来自多个操作型系统的完整的历史数据。 </p>
</li>
<li><p>Data Vault方法需要跟踪所有数据的来源，因此其中每个数据行都要包含数据来源和装载时间属性， 用以审计和跟踪数据值所对应的源系统。 </p>
</li>
<li><p>Data Vault不区分数据在业务层面的正确与错误， 它保留操作型系统的所有时间的所有数据， 装载数据时不做数据验证、清洗等工作， 这点明显有别于其他数据仓库建模方法。 </p>
</li>
<li><p>Data Vault建模方法显式地将结构信息和属性信息分离， 能够还原业务环境的变化。 Data Vault允许并行数据装载，不需要重新设计就可以实现扩展。</p>
</li>
</ul>
<p>Data Vault是面向细节的，可追踪历史的，一组有连接关系的规范化的表的集合。 这些表可以支持一个或多个业务功能。<br>它是一种综合了第三范式（3NF）和星型模型优点的建模方法。<br>其设计理念是要满足企业对灵活性、 可扩展性、 一致性和对需求的适应性要求， 是一种专为企业级数据仓库量身定制的建模方式</p>
<h3 id="Data-Vault-模型各类表说明"><a href="#Data-Vault-模型各类表说明" class="headerlink" title="Data Vault 模型各类表说明"></a>Data Vault 模型各类表说明</h3><p>对于Data Vault主要分为3种类型的表：中心表，链接表，卫星表（附属表）。</p>
<h4 id="中心表"><a href="#中心表" class="headerlink" title="中心表"></a>中心表</h4><p>对于构建Data Vault模型的，第一件事就是构建中心表，中心表示DV模型中的核心。如果设计得当，将可以兼容整合各种数据源。<br>为了达到这点，就应该假设系统源是不可知的，所以中心表应该依赖于实际的业务逻辑标识，而不是使用代理键。</p>
<p>中心表的表结构：</p>
<table>
<thead>
<tr>
<th>字段</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>hub_key</td>
<td style="text-align:left">代理主键，通过对业务主键进行MD5计算所得</td>
</tr>
<tr>
<td>business_key</td>
<td style="text-align:left">业务主键,唯一标识业务主键，来之源系统</td>
</tr>
<tr>
<td>load_dts</td>
<td style="text-align:left">数据第一次转载的时间,只记录第一次转载时间</td>
</tr>
<tr>
<td>rec_src</td>
<td style="text-align:left">数据源系统</td>
</tr>
</tbody>
</table>
<h4 id="链接表"><a href="#链接表" class="headerlink" title="链接表"></a>链接表</h4><p>链接表的目的是为了灵活性和易扩展，通过链接表可以在不改变原有的构架和转载条件下进行扩展。在Data Vault模型中所有的<br>关系和事件都是通过链接表来表示。在DV模型中，中心表没有外键，对于中心表间的连接是通过链接表。所以连接表至少要有两个<br>父中心表。</p>
<p>链接表表结构：</p>
<table>
<thead>
<tr>
<th>字段</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>link_key</td>
<td style="text-align:left">代理主键，使用相关的父Hub表的业务主键拼接后计算MD5值</td>
</tr>
<tr>
<td>hub_keys</td>
<td style="text-align:left">hubs的代理键</td>
</tr>
<tr>
<td>hub_business_keys</td>
<td style="text-align:left">hubs的业务主键</td>
</tr>
<tr>
<td>load_dts</td>
<td style="text-align:left">第一次装载数据的时间</td>
</tr>
<tr>
<td>rec_src</td>
<td style="text-align:left">源系统信息</td>
</tr>
</tbody>
</table>
<h4 id="卫星表（附属表）"><a href="#卫星表（附属表）" class="headerlink" title="卫星表（附属表）"></a>卫星表（附属表）</h4><p>卫星表示所有的原始数据系统，在这个表中也捕获数据的变化，所以这种表有点像维度模型中的渐变维度表。<br>一个附属表总有一个且唯一一个外键引用到中心表或链接表。</p>
<table>
<thead>
<tr>
<th>字段</th>
<th style="text-align:left">说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>sta_key</td>
<td style="text-align:left">代理主键，相关的hub或link表的主键和数据载入时间的MD5值</td>
</tr>
</tbody>
</table>
<p>HASHBYTES(‘MD5’,[CustomerID]+[CompanyName])</p>

          
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/12/8-Hive调优/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/fly.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LYJ-NEO">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/12/8-Hive调优/" itemprop="url">
                  8-Hive调优
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-12-12 11:25:41" itemprop="dateCreated datePublished" datetime="2018-12-12T11:25:41+08:00">2018-12-12</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-02-03 14:00:39" itemprop="dateModified" datetime="2020-02-03T14:00:39+08:00">2020-02-03</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tec/" itemprop="url" rel="index"><span itemprop="name">Tec</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h2 id="技术-1：使用TEZ"><a href="#技术-1：使用TEZ" class="headerlink" title="技术#1：使用TEZ"></a>技术#1：使用TEZ</h2><p>Hive可以使用Apache Tez执行引擎而不是Map-reduce引擎。不会详细介绍这里提到的使用Tez的许多好处; 相反，提出一个简单的建议：如果在您的环境中默认情况下没有打开它，请在Hive查询的开头使用Tez设置为“true”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">set hive.execution.engine=tez;</span><br></pre></td></tr></table></figure>
<h2 id="技术-2：使用ORCFILE"><a href="#技术-2：使用ORCFILE" class="headerlink" title="技术#2：使用ORCFILE"></a>技术#2：使用ORCFILE</h2><p>Hive支持ORCfile，这是一种新的表存储格式，通过谓词下推，压缩等技术实现极佳的速度提升。<br>对每个HIVE表使用ORCFile应该是一个明智的选择，对于获得HIVE查询的快速响应时间非常有益。<br>作为一个例子，考虑两个大表A和B（存储为文本文件，这里没有指定一些列），以及一个简单的查询 :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT A.customerID, A.name, A.age, A.address join</span><br><span class="line">B.role, B.department, B.salary</span><br><span class="line">ON A.customerID=B.customerID;</span><br></pre></td></tr></table></figure>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018/12/12/8-Hive调优/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/12/7-Hive设计模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/fly.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LYJ-NEO">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/12/7-Hive设计模式/" itemprop="url">
                  7-Hive设计模式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-12-12 11:25:17" itemprop="dateCreated datePublished" datetime="2018-12-12T11:25:17+08:00">2018-12-12</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-02-03 14:01:26" itemprop="dateModified" datetime="2020-02-03T14:01:26+08:00">2020-02-03</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tec/" itemprop="url" rel="index"><span itemprop="name">Tec</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h2>Hive设计模式</h2>

<p>hive是基于Hadoop的一个数据仓库工具，可以将结构化的数据文件映射为一张数据库表，并提供简单的sql查询功能，可以将sql语句转换为MapReduce任务进行运行。<br>对于传统关系数据构建数据仓库的建模方法，对于Hive是否适用 ； 针对Hive自身特点，需要如何合理构建 ，本文将记将进行探讨。</p>
<p>Hive看上去及实际行为都像一个关系型数据库，但Hive实现和使用和传统的关系型数据库是非常不同的，事实上Hive是反模式的。</p>
<h2>数据仓库数据模型</h2>

<p><strong>数据模型是抽象描述现实世界的一种工具和方法，是通过抽象的实体及实体之间联系的形式，来表示现实世界中事务的相互关系的一种映射</strong></p>
<p>数据仓库的数据模型的架构和数据仓库的整体架构是紧密关联在一起的，我们首先来了解一下整个数据仓库的数据模型应该包含的几个部分。<br>从下图我们可以很清楚地看到，整个数据模型的架构分成 5 大部分，每个部分其实都有其独特的功能。<br><img src="/2018/12/12/7-Hive设计模式/dw_model.jpg" alt=""></p>
<ul>
<li>系统记录域（System of Record）：这部分是主要的数据仓库业务数据存储区，数据模型在这里保证了数据的一致性。</li>
<li>内部管理域（Housekeeping）：这部分主要存储数据仓库用于内部管理的元数据，数据模型在这里能够帮助进行统一的元数据的管理。</li>
<li>汇总域（Summary of Area）：这部分数据来自于系统记录域的汇总，数据模型在这里保证了分析域的主题分析的性能，满足了部分的报表查询。</li>
<li>分析域（Analysis Area）：这部分数据模型主要用于各个业务部分的具体的主题业务分析。这部分数据模型可以单独存储在相应的数据集市中。</li>
<li>反馈域（Feedback Area）：可选项，这部分数据模型主要用于相应前端的反馈数据，数据仓库可以视业务的需要设置这一区域。</li>
</ul>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018/12/12/7-Hive设计模式/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/12/6-Hive视图和索引/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/fly.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LYJ-NEO">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/12/6-Hive视图和索引/" itemprop="url">
                  6-Hive视图和索引
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-12-12 11:24:32" itemprop="dateCreated datePublished" datetime="2018-12-12T11:24:32+08:00">2018-12-12</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-02-03 13:55:01" itemprop="dateModified" datetime="2020-02-03T13:55:01+08:00">2020-02-03</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tec/" itemprop="url" rel="index"><span itemprop="name">Tec</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h2>视图</h2><br>视图可以允许保存一个查询并像对待表一样对这个查询j进行操作，这是要给逻辑结构，因为它不会像一个表会存储数据，<br>当一个查询引用一个视图时，这个视图说定义的查询语句和用户查询语句结合在一起，然后Hive指定查询计划，从逻辑上讲<br>Hive先执行这个视图，然后使用这个结果进行后续的查询。<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">创建视图： </span><br><span class="line"></span><br><span class="line">CREATE VIEW [IF NOT EXISTS] view_name [(column_name [COMMENT column_comment], ...) ]</span><br><span class="line">[COMMENT table_comment]</span><br><span class="line">AS SELECT ...</span><br></pre></td></tr></table></figure><br><br><img src="/2018/12/12/6-Hive视图和索引/1_create_view.png" alt=""><br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">删除视图：</span><br><span class="line"></span><br><span class="line">DROP VIEW view_name ;</span><br></pre></td></tr></table></figure><br><br><img src="/2018/12/12/6-Hive视图和索引/2_drop_view.png" alt=""><br><br><em> 使用视图来降低查询复杂度<br>  查询长或复杂的时候，使用视图将这个查询语句分割成多个小的，更可控的片段可以降低这种复杂度。

</em> 使用视图来限制基于条件过滤的数据<br>  对于视图来说，一个常见的使用场景是基于一个或多个列值来限制输出结果。有些数据库运行将视图作为一种安全机制，不给用户直接访问敏感数据的原始表，<br>  而提供给用户提供一个通过WHERE子句限制了的视图。<br>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018/12/12/6-Hive视图和索引/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/01/5-Hive数据查询/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/fly.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LYJ-NEO">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/12/01/5-Hive数据查询/" itemprop="url">
                  5-Hive数据查询
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-12-01 11:24:02" itemprop="dateCreated datePublished" datetime="2018-12-01T11:24:02+08:00">2018-12-01</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2020-02-03 14:03:38" itemprop="dateModified" datetime="2020-02-03T14:03:38+08:00">2020-02-03</time>
              
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Tec/" itemprop="url" rel="index"><span itemprop="name">Tec</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h2>SELECT子句</h2>

<ul>
<li>针对复合类型列的查询(数组，字典，结构)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">含有复合类型列的样表：</span><br><span class="line">CREATE TABLE IF NOT EXISTS employees_t</span><br><span class="line">(</span><br><span class="line">    name STRING  COMMENT &apos;Employee name&apos;,</span><br><span class="line">    salary FLOAT COMMENT &apos;Employee salary&apos;,</span><br><span class="line">    subordinates ARRAY&lt;STRING&gt; COMMENT &apos; Names of subordinates&apos;,</span><br><span class="line">    deducations  MAP&lt;STRING,FLOAT&gt; COMMENT &apos; Keys are deducations names , Values are percentags&apos;,</span><br><span class="line">    address      STRUCT&lt;street:STRING,city:STRING,state:STRING,zip:INT&gt; COMMENT &apos;Home Address&apos;</span><br><span class="line">)</span><br><span class="line">COMMENT &apos;the table of empoyee&apos;</span><br><span class="line">ROW FORMAT DELIMITED</span><br><span class="line">FIELDS TERMINATED BY &apos;\001&apos;</span><br><span class="line">COLLECTION ITEMS TERMINATED BY &apos;\002&apos;</span><br><span class="line">MAP KEYS TERMINATED BY &apos;\003&apos;</span><br><span class="line">LINES TERMINATED BY &apos;\n&apos;</span><br><span class="line">STORED AS TEXTFILE;</span><br><span class="line">数据样式：</span><br></pre></td></tr></table></figure>
<p><img src="/2018/12/01/5-Hive数据查询/1_mul_data_style.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">访问数组列，使用下标索引:</span><br><span class="line">SELECT name , subordinates[0] FROM employees_t linit 3;</span><br></pre></td></tr></table></figure>
<p><img src="/2018/12/01/5-Hive数据查询/2_array_sub.png" alt=""></p>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2018/12/01/5-Hive数据查询/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    

    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/3/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/fly.jpg"
                alt="" />
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">57</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">3</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">12</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder"></span>

  

  
</div>











        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="总访客量">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="总访问量">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.4.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.4.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.4.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.4.1"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.4.1"></script>



  



  






<!-- LOCAL: You can save these files to your site and update links -->
    
        
        <link rel="stylesheet" href="https://aimingoo.github.io/gitmint/style/default.css">
        <script src="https://aimingoo.github.io/gitmint/dist/gitmint.browser.js"></script>
    
<!-- END LOCAL -->

    
      <style>
        a.gitment-editor-footer-tip { display: none; }
        .gitment-container.gitment-footer-container { display: none; }
      </style>
    

    






  





  

  

  

  

  
  

  

  

  

  

  

</body>
</html>
